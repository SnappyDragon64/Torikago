[gd_scene load_steps=11 format=3 uid="uid://cdcov0ancsa1y"]

[ext_resource type="Script" path="res://game/entity/player/player.gd" id="1_u23no"]
[ext_resource type="Script" path="res://game/entity/state_machine/state_machine.gd" id="1_vcpkk"]
[ext_resource type="Script" path="res://game/entity/player/run_state.gd" id="2_k78y2"]
[ext_resource type="Script" path="res://game/entity/player/idle_state.gd" id="3_y24cg"]
[ext_resource type="Script" path="res://game/entity/player/jump_state.gd" id="4_qi5n4"]
[ext_resource type="Script" path="res://game/entity/player/fall_state.gd" id="5_ilmt4"]
[ext_resource type="PackedScene" uid="uid://caioeub6pwumj" path="res://game/entity/player/player_model.tscn" id="7_k4am0"]
[ext_resource type="Script" path="res://game/entity/player/dash_state.gd" id="8_0do5e"]
[ext_resource type="Script" path="res://game/entity/player/slide_state.gd" id="9_g5ry0"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_tfoky"]
radius = 20.0
height = 136.0

[node name="Player" type="CharacterBody2D"]
collision_mask = 3
script = ExtResource("1_u23no")

[node name="PlayerModel" parent="." instance=ExtResource("7_k4am0")]
scale = Vector2(1.2, 1.2)

[node name="Hitbox" type="CollisionShape2D" parent="."]
position = Vector2(0, -68)
shape = SubResource("CapsuleShape2D_tfoky")

[node name="StateMachine" type="Node" parent="."]
script = ExtResource("1_vcpkk")
initial_state = NodePath("IdleState")

[node name="IdleState" type="Node" parent="StateMachine"]
script = ExtResource("3_y24cg")
state_id = "idle"

[node name="RunState" type="Node" parent="StateMachine"]
script = ExtResource("2_k78y2")
state_id = "run"

[node name="JumpState" type="Node" parent="StateMachine"]
script = ExtResource("4_qi5n4")
state_id = "jump"

[node name="PostWallJumpMoveTimer" type="Timer" parent="StateMachine/JumpState"]
wait_time = 0.25
one_shot = true

[node name="FallState" type="Node" parent="StateMachine"]
script = ExtResource("5_ilmt4")
state_id = "fall"

[node name="JumpQueueTimer" type="Timer" parent="StateMachine/FallState"]
process_callback = 0
wait_time = 0.25
one_shot = true

[node name="CoyoteTimer" type="Timer" parent="StateMachine/FallState"]
process_callback = 0
wait_time = 0.25
one_shot = true

[node name="DashState" type="Node" parent="StateMachine"]
script = ExtResource("8_0do5e")
state_id = "dash"

[node name="DashTimer" type="Timer" parent="StateMachine/DashState"]
process_callback = 0
wait_time = 0.2
one_shot = true

[node name="CooldownTimer" type="Timer" parent="StateMachine/DashState"]
process_callback = 0
wait_time = 0.4
one_shot = true

[node name="SlideState" type="Node" parent="StateMachine"]
script = ExtResource("9_g5ry0")
state_id = "slide"

[node name="Raycasts" type="Node2D" parent="."]

[node name="HandRaycastR" type="RayCast2D" parent="Raycasts"]
position = Vector2(20, -145)
target_position = Vector2(0.1, 0)
collision_mask = 2
hit_from_inside = true

[node name="FootRaycastR" type="RayCast2D" parent="Raycasts"]
position = Vector2(20, -2)
target_position = Vector2(0.1, 0)
collision_mask = 2
hit_from_inside = true

[node name="HandRaycastL" type="RayCast2D" parent="Raycasts"]
position = Vector2(-20, -145)
target_position = Vector2(-0.1, 0)
collision_mask = 2
hit_from_inside = true

[node name="FootRaycastL" type="RayCast2D" parent="Raycasts"]
position = Vector2(-20, -2)
target_position = Vector2(-0.1, 0)
collision_mask = 2
hit_from_inside = true

[connection signal="timeout" from="StateMachine/JumpState/PostWallJumpMoveTimer" to="StateMachine/JumpState" method="_post_wall_jump_move_timeout"]
[connection signal="timeout" from="StateMachine/FallState/JumpQueueTimer" to="StateMachine/FallState" method="_jump_queue_timeout"]
[connection signal="timeout" from="StateMachine/FallState/CoyoteTimer" to="StateMachine/FallState" method="_coyote_timeout"]
[connection signal="timeout" from="StateMachine/DashState/DashTimer" to="StateMachine/DashState" method="_dash_timeout"]
[connection signal="timeout" from="StateMachine/DashState/CooldownTimer" to="StateMachine/DashState" method="_cooldown_timeout"]
